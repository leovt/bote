<!DOCTYPE html>
<html>
<body>
  <ul id="log" style="overflow:scroll; height:300px;"></ul>
  <button onclick="log_refresh()">Refresh</button>
  <button onclick="send_answer()">Answer</button>
  <select id="question"></select>
</body>
<script>
log_count = 0;

function create() {
  var httpRequest = new XMLHttpRequest();
  httpRequest.addEventListener("load", function () {
    game_uri = httpRequest.getResponseHeader('Location');
  });
  httpRequest.open("POST", `/game/create`);
  httpRequest.send();
}

create();

function log_refresh () {
  var httpRequest = new XMLHttpRequest();
  httpRequest.addEventListener("load", function () {
    result = JSON.parse(httpRequest.responseText)
    var list = document.getElementById('log');
    for (var key in result) {
      log_count += 1;
      console.log(result[key].event_id)
      var entry = document.createElement('li');
      entry.appendChild(document.createTextNode(JSON.stringify(result[key])));
      list.appendChild(entry);
    }
  })
  httpRequest.open("GET", `${game_uri}/log?first=${log_count}`);
  httpRequest.send()
}

function send_answer () {
  var httpRequest = new XMLHttpRequest();
  httpRequest.open("POST", `${game_uri}/answer`);
  httpRequest.setRequestHeader('Content-Type', 'application/json');
  httpRequest.send(JSON.stringify({"answer":0}));
}

</script>
</html>
